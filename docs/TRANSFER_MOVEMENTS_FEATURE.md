# Функционал перемещения товаров

## Описание

Новый улучшенный интерфейс для создания перемещений товаров между складами с проверкой остатков.

## Особенности

### 1. Выбор складов
- **Склад отправитель** - склад, с которого перемещаются товары
- **Склад получатель** - склад, на который перемещаются товары
- Нельзя выбрать один и тот же склад как отправителя и получателя

### 2. Проверка остатков
- При выборе склада отправителя автоматически загружаются остатки товаров
- В списке доступных товаров показываются только товары с остатками > 0
- Для каждого товара указано доступное количество

### 3. Ограничение количества
- Максимальное количество для перемещения ограничено остатками на складе
- При вводе количества автоматически применяется валидация:
  - Минимум: 0
  - Максимум: количество на складе отправителя
- В интерфейсе видно доступное количество для каждого товара

### 4. Удобный интерфейс
- Адаптивный дизайн для всех устройств
- Три колонки на больших экранах (информация, товары, итоги)
- Автоматический расчет сумм
- Кнопка быстрого добавления товаров
- Возможность удаления добавленных товаров

### 5. Информация об остатках
Для каждого товара в списке показывается:
- Название товара
- Доступное количество на складе
- Единица измерения
- Средняя цена

### 6. Итоговая информация
В боковой панели отображается:
- Количество товаров (позиций)
- Общее количество единиц
- Общая сумма перемещения
- Подсказки по использованию

## Использование

### Создание перемещения

1. **Перейдите на страницу "История движений товаров"**
   - В главном меню выберите "Движения товаров"
   
2. **Нажмите кнопку "Создать перемещение"**
   - В правом верхнем углу страницы

3. **Заполните информацию о документе**
   - Выберите склад отправитель
   - Выберите склад получатель
   - Укажите дату перемещения (по умолчанию текущая дата)
   - При необходимости добавьте примечание

4. **Добавьте товары**
   - После выбора склада отправителя станет доступен список товаров
   - Выберите товар из выпадающего списка (показываются только товары с остатками)
   - Нажмите кнопку "Добавить"
   - Укажите количество для перемещения
   - При необходимости добавьте другие товары

5. **Проверьте итоги**
   - В правой панели отображается общая информация
   - Проверьте количество и суммы

6. **Создайте документ**
   - Нажмите кнопку "Создать перемещение"
   - Документ будет создан в статусе "DRAFT" (черновик)
   - После создания вы будете перенаправлены на страницу документов

7. **Проведите документ**
   - На странице документов найдите созданный документ
   - Нажмите кнопку "Провести" для проведения документа
   - После проведения товары будут перемещены между складами

## Технические детали

### Файлы

- `/client/src/pages/StockMovements/CreateTransferPage.tsx` - страница создания перемещения
- `/client/src/pages/StockMovements/StockMovementsPage.tsx` - обновлена, добавлена кнопка создания
- `/client/src/pages/StockMovements/index.ts` - экспорт компонентов
- `/client/src/App.tsx` - добавлен маршрут `/stock-movements/create`

### API Endpoints

- `GET /api/warehouses/{id}/stock-balances` - получение остатков по складу
- `POST /api/documents` - создание документа перемещения
- `POST /api/documents/{id}/items` - добавление позиций в документ
- `POST /api/documents/{id}/approve` - проведение документа

### Типы документов

```typescript
type: 'TRANSFER'
status: 'DRAFT' | 'APPROVED' | 'CANCELLED'
```

### Состояния

- **DRAFT** - черновик, можно редактировать
- **APPROVED** - проведен, товары перемещены
- **CANCELLED** - отменен

## Валидация

### Клиентская валидация

1. Склад отправитель обязателен
2. Склад получатель обязателен
3. Склады должны быть разными
4. Должен быть добавлен хотя бы один товар
5. Количество каждого товара должно быть > 0
6. Количество не может превышать остаток на складе

### Серверная валидация

1. Проверка существования складов
2. Проверка существования товаров
3. Проверка остатков на складе отправителя
4. Проверка прав доступа пользователя

## Преимущества нового интерфейса

1. **Безопасность** - невозможно переместить больше товаров, чем есть на складе
2. **Удобство** - визуальное отображение доступных остатков
3. **Скорость** - быстрое добавление товаров из списка
4. **Прозрачность** - видно все суммы и количества до создания документа
5. **Валидация** - проверки на каждом этапе предотвращают ошибки

## Рекомендации

1. Всегда проверяйте остатки перед созданием перемещения
2. Используйте примечания для указания причины перемещения
3. Проводите документы сразу после проверки
4. При необходимости создавайте резервные копии перед массовыми перемещениями

## Планы развития

- Добавление сканера штрих-кодов
- Групповое добавление товаров
- Шаблоны перемещений
- История изменений документа
- Печать документов перемещения
- Экспорт в Excel
