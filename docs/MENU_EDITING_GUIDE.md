# Руководство по управлению меню

## Обзор

Система управления меню позволяет создавать меню ресторана, добавлять в них категории (группы блюд) и позиции меню (конкретные блюда).

## Структура меню

```
Меню (например, "Летнее меню 2025")
├── Категория "Первые блюда"
│   ├── Борщ украинский
│   ├── Солянка мясная
│   └── Уха из семги
├── Категория "Вторые блюда"
│   ├── Стейк рибай
│   ├── Паста карбонара
│   └── Лосось на гриле
└── Категория "Десерты"
    ├── Тирамису
    ├── Панна котта
    └── Чизкейк
```

## Как работать с меню

### 1. Создание меню

1. Перейдите в **Меню** (`/menu`)
2. Нажмите кнопку **"Создать меню"**
3. Заполните поля:
   - **Название** (обязательно) - например, "Летнее меню 2025"
   - **Описание** - краткое описание меню
   - **Дата начала** - когда меню начнет действовать
   - **Дата окончания** - когда меню перестанет действовать
4. Нажмите **"Создать"**

### 2. Настройка содержимого меню

После создания меню:

1. В списке меню найдите нужное
2. Нажмите кнопку **"Настроить"**
3. Откроется страница редактирования меню

### 3. Добавление категорий (групп блюд)

На странице редактирования меню:

1. Нажмите **"Добавить категорию"**
2. Заполните форму:
   - **Название** (обязательно) - например, "Первые блюда", "Вторые блюда", "Десерты"
   - **Описание** - дополнительная информация
   - **Порядок сортировки** - число для упорядочивания категорий
3. Нажмите **"Сохранить"**

### 4. Добавление позиций меню (блюд)

На странице редактирования меню:

1. Нажмите **"Добавить блюдо"**
2. Заполните форму:
   - **Блюдо (продукт)** (обязательно) - выберите готовое блюдо из номенклатуры
   - **Категория** - выберите категорию или оставьте "Без категории"
   - **Название** (обязательно) - название позиции в меню (заполняется автоматически)
   - **Описание** - описание блюда для гостей
   - **Цена** (обязательно) - продажная цена
   - **Себестоимость** - для расчета прибыли
   - **URL изображения** - ссылка на фото блюда
   - **Порядок сортировки** - для упорядочивания в категории
3. Нажмите **"Сохранить"**

### 5. Редактирование и удаление

#### Редактирование категории:
- Нажмите иконку **карандаша** рядом с названием категории
- Внесите изменения
- Нажмите **"Сохранить"**

#### Удаление категории:
- Нажмите иконку **корзины** рядом с названием категории
- Подтвердите удаление
- ⚠️ Позиции меню из этой категории останутся, но будут отнесены к "Без категории"

#### Редактирование позиции:
- Нажмите иконку **карандаша** рядом с позицией
- Внесите изменения
- Нажмите **"Сохранить"**

#### Удаление позиции:
- Нажмите иконку **корзины** рядом с позицией
- Подтвердите удаление

### 6. Активация/деактивация меню

На странице списка меню:
- Нажмите **"Деактивировать"** для отключения меню
- Нажмите **"Активировать"** для включения меню

Неактивные меню не отображаются в системе продаж.

## Важные моменты

### Связь с продуктами

Позиции меню ссылаются на **продукты** из номенклатуры, а не напрямую на рецептуры.

**Для создания позиции меню нужно:**
1. Создать продукт в номенклатуре (например, "Борщ украинский")
2. Если у блюда есть рецептура, связать продукт с рецептурой
3. Добавить этот продукт как позицию в меню

### Проверка доступности

Система автоматически проверяет доступность блюд:
- Если у продукта есть рецептура, проверяется наличие всех ингредиентов на складе
- Если ингредиентов недостаточно, блюдо помечается как недоступное

### Категории vs Группы

**Категории меню** (`MenuCategory`) - это группы блюд:
- Первые блюда
- Вторые блюда
- Гарниры
- Салаты
- Десерты
- Напитки

Они используются для организации позиций внутри меню.

### Множественные меню

Вы можете создать несколько меню:
- **Летнее меню** - с сезонными блюдами
- **Зимнее меню** - с горячими блюдами
- **Детское меню** - специальные блюда для детей
- **Банкетное меню** - для мероприятий
- **Обеденное меню** - комплексные обеды

Каждое меню может иметь свой набор категорий и позиций.

## Примеры использования

### Пример 1: Создание летнего меню

```
Меню: "Летнее меню 2025"
Даты: 01.06.2025 - 31.08.2025

Категория: "Холодные супы"
├── Окрошка классическая - 350₽
├── Гаспачо - 380₽
└── Свекольник холодный - 320₽

Категория: "Салаты"
├── Греческий салат - 420₽
├── Цезарь с креветками - 580₽
└── Салат с тунцом - 520₽

Категория: "Легкие блюда"
├── Тар-тар из лосося - 680₽
├── Карпаччо из говядины - 720₽
└── Сашими микс - 890₽
```

### Пример 2: Обеденное меню

```
Меню: "Бизнес-ланч"
Время: будние дни 12:00-16:00

Категория: "Комплекс №1" (450₽)
├── Суп дня
├── Котлета по-киевски с гарниром
└── Компот

Категория: "Комплекс №2" (480₽)
├── Борщ
├── Куриное филе с овощами
└── Чай/кофе

Категория: "Комплекс №3" (520₽)
├── Солянка
├── Стейк из индейки
└── Десерт дня
```

## Частые вопросы

**Q: Можно ли использовать одно блюдо в нескольких меню?**
A: Да, один продукт можно добавить в несколько меню как разные позиции.

**Q: Как изменить цену блюда только в одном меню?**
A: При добавлении позиции в меню указывайте нужную цену. Она не зависит от цены в рецептуре.

**Q: Что делать если блюда нет в номенклатуре?**
A: Сначала создайте продукт в разделе "Номенклатура", затем добавьте его в меню.

**Q: Как удалить меню со всеми позициями?**
A: При удалении меню все его позиции удаляются автоматически (каскадное удаление).

**Q: Можно ли добавить позицию без категории?**
A: Да, при создании позиции выберите "Без категории". Такие позиции будут отображаться в отдельной группе.

## Интерфейс

### Маршруты

- `/menu` - список всех меню
- `/menu/:id/edit` - редактирование конкретного меню
- `/menu/display` - отображение меню для гостей
- `/menu/categories` - управление категориями меню (глобальное)
- `/menu/items` - управление всеми позициями меню

### Кнопки и действия

- **Настроить** - открыть редактор меню
- **Активировать/Деактивировать** - изменить статус меню
- **Редактировать** (карандаш) - изменить меню/категорию/позицию
- **Удалить** (корзина) - удалить меню/категорию/позицию
- **Добавить категорию** - создать новую группу блюд
- **Добавить блюдо** - создать новую позицию в меню

## Технические детали

### API эндпоинты

- `GET /api/menu/:id` - получить меню со всеми позициями
- `GET /api/menu/categories` - список категорий
- `POST /api/menu/categories` - создать категорию
- `PUT /api/menu/categories/:id` - обновить категорию
- `DELETE /api/menu/categories/:id` - удалить категорию
- `GET /api/menu/items?menuId=X` - позиции конкретного меню
- `POST /api/menu/items` - создать позицию
- `PUT /api/menu/items/:id` - обновить позицию
- `DELETE /api/menu/items/:id` - удалить позицию

### Модели данных

```typescript
Menu {
  id: number
  name: string
  description?: string
  startDate?: Date
  endDate?: Date
  isActive: boolean
}

MenuCategory {
  id: number
  name: string
  description?: string
  sortOrder: number
  isActive: boolean
}

MenuItem {
  id: number
  menuId: number
  productId: number
  categoryId?: number
  name: string
  description?: string
  price: number
  costPrice?: number
  imageUrl?: string
  isAvailable: boolean
  sortOrder: number
}
```
